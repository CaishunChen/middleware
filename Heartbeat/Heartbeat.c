
///////////////////////////////////////////////////////////////////////////////////////////////////
//                                      Includes Section
///////////////////////////////////////////////////////////////////////////////////////////////////
#include <stdint.h>
#include "SW_Timer.h"
#include "Led.h"
#include "Heartbeat.h"
///////////////////////////////////////////////////////////////////////////////////////////////////
//                                   Defines & Macros Section
///////////////////////////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////////////////////////
//                                       Typedef Section
///////////////////////////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////////////////////////
//                                  Function Prototypes Section
///////////////////////////////////////////////////////////////////////////////////////////////////

static void Hearbeat_EnableTimerCallback(void);

static void Hearbeat_FlashTimerCallback(void);

///////////////////////////////////////////////////////////////////////////////////////////////////
//                                   Global Constants Section
///////////////////////////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////////////////////////
//                                   Static Constants Section
///////////////////////////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////////////////////////
//                                   Global Variables Section
///////////////////////////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////////////////////////
//                                   Static Variables Section
///////////////////////////////////////////////////////////////////////////////////////////////////

static uint8_t Hearbeat_EnableTimer;

static uint8_t Heartbeat_FlashTimer;

///////////////////////////////////////////////////////////////////////////////////////////////////
//                                      Functions Section
///////////////////////////////////////////////////////////////////////////////////////////////////

void Heartbeat_Initialization(void)
{
	Hearbeat_EnableTimer = SWTimer_AllocateChannel(HEARTBEAT_RATE_IN_MS,Hearbeat_EnableTimerCallback);

	Heartbeat_FlashTimer = SWTimer_AllocateChannel(HEARTBEAT_FLASH_RATE_IN_MS,Hearbeat_FlashTimerCallback);
}

void Heartbeat_Start(void)
{
	SWTimer_EnableTimer(Hearbeat_EnableTimer);
}

void Heartbeat_Stop(void)
{
	Led_TurnOff(HEARTBEAT_LED);
	SWTimer_DisableTimer(Hearbeat_EnableTimer);
	SWTimer_DisableTimer(Heartbeat_FlashTimer);
}

static void Hearbeat_EnableTimerCallback(void)
{
	/* turn on heartbeat */
	Led_TurnOn(HEARTBEAT_LED);

	/* start the timer */
	SWTimer_EnableTimer(Heartbeat_FlashTimer);
}

static void Hearbeat_FlashTimerCallback(void)
{
	Led_TurnOff(HEARTBEAT_LED);
	/* disable this timer */
	SWTimer_DisableTimer(Heartbeat_FlashTimer);
}
///////////////////////////////////////////////////////////////////////////////////////////////////
// EOF
///////////////////////////////////////////////////////////////////////////////////////////////////


